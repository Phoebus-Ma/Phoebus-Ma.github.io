

# 51. Typesetting
--------

This chapter includes texlive applications that create output equivalent to typesetting.

There are two alternative routes through this chapter:

Some people may wish to use the binary installer, either because of the complexity of installing all of texlive from source, or because they only want a part of the package, or perhaps because they wish to get updates as soon as those are available (the source is only updated annually, but the binaries and associated tex and sty files are updated for approximately 10 months). These people should begin at [Setting the PATH for TeX Live](51.Typesetting.md#511-setting-the-path-for-tex-live) and then follow the [install-tl-unx](51.Typesetting.md#512-install-tl-unx) instructions. After installing, they can run **tlmgr** to update their system.

Most people reading BLFS will wish to build from source. BLFS used to start by installing install-tl-unx and then use that to bootstrap the build. Nowadays, we build almost the whole of texlive without a binary install, by adding the separately-packaged texmf files into this build. For this, begin at [Setting the PATH for TeX Live](51.Typesetting.md#511-setting-the-path-for-tex-live) then go to [texlive-20220321](51.Typesetting.md#513-texlive-20220321-source) which will install most of texlive, together with all of the supporting files. This almost-complete install can then be used to build the remaining parts of texlive: [asymptote-2.85](51.Typesetting.md#514-asymptote-285) and [xindy-2.5.1](51.Typesetting.md#517-xindy-251).

Because the texmf files (including documentation, fonts, scripts and supporting files) are all in one tarball, it is not practical to limit what gets extracted in a sensible way (you could exclude one or other of the typesetting engines, not its many supporting files) when building from source in this manner.

In either case, BLFS installs into `/opt/texlive/2022`.

Also, please note that texlive is released annually, and updating from the previous year to the current year is no longer supported. If for some reason you wish to keep versions for multiple years, for most things you can mount the old or new system at /opt/texlive and fix up your PATH as necessary. However doing that will not preserve any changes in `texmf-local` and if you build from source and try to run a newer version of biber with an older version of biblatex it is unlikely to work.


## 51.1 Setting the PATH for TeX Live
--------

Before starting to build TeX Live, set up your PATH so that the system can properly find the files. If you set up your login scripts as recommended in [The Bash Shell Startup Files](3.After_lfs_configuration_issues.md#37-the-bash-shell-startup-files), update the needed paths by creating the `texlive.sh` script. The programs are always installed in an <ARCH>-linux subdirectory and on 32-bit x86 this is always i386-linux. For x86_64 and i?86 we can generate this as $TEXARCH:

### Note

If upgrading from a previous year's version, you should manually edit `texlive.sh` to ensure that the version for the year you wish to use is the only TeX present (some people need to keep multiple years available to ensure there are no regressions in their documents).

Now, create the texlive.sh script as the `root` user:

```bash
TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/')

cat > /etc/profile.d/texlive.sh << EOF
# Begin texlive setup
TEXLIVE_PREFIX=/opt/texlive/2022
export TEXLIVE_PREFIX

pathappend \$TEXLIVE_PREFIX/texmf-dist/doc/man  MANPATH
pathappend \$TEXLIVE_PREFIX/texmf-dist/doc/info INFOPATH
pathappend \$TEXLIVE_PREFIX/bin/$TEXARCH

# End texlive setup
EOF

unset TEXARCH
```

### Note

The standard MANPATH and INFOPATH path are specified above to ensure they are included. If they are already set in the boot script procedure, the pathappend function will ensure duplicates are removed, so including them here will do no harm.

### Note

The backslashes before the dollar signs in the script above are to facilitate a copy/paste operation. The backslashes should not appear in the actual script.

The new paths can be immediately activated by running **source /etc/profile**.

You should now proceed either to [install-tl-unx](51.Typesetting.md#512-install-tl-unx) for a binary installation of texlive, or to [texlive-20220321](51.Typesetting.md#513-texlive-20220321-source) to begin installing from source.


## 51.2 install-tl-unx
--------

Introduction to TeX Live and its installer
------------------------------------------

The TeX Live package is a comprehensive TeX document production system. It includes TeX, LaTeX2e, ConTeXt, Metafont, MetaPost, BibTeX and many other programs; an extensive collection of macros, fonts and documentation; and support for typesetting in many different scripts from around the world.

This page is for people who wish to use the binary installer to provide the programs, the scripts, and a lot of supporting files and documentation. The installer is updated frequently, so any published md5sum will soon be out of date. Newer versions of the installer are expected to work with these instructions, for so long as they install to a `2022/` directory.

There are two reasons why you may wish to install the binaries in BLFS: either you need a smaller install (e.g. at a minimum plain TeX without LaTeX2e, ConTeXt, etc), or you wish to use **tlmgr** to get updates whilst this version is supported (typically, until April of the year after it was released). For the latter, you might prefer to install in your `/home` directory as an unprivileged user, and to then make corresponding changes to the PATH in your `~/.bashrc` or equivalent.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz](https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz)
    
*   Download MD5 sum: Varies frequently
    
*   Download size: 5.6 MB
    
*   Estimated disk space required: 118 MB for basic TeX and latex, 7.1 GB if everything is included
    
*   Estimated build time: varies, depending on network speed and traffic
    

#### Recommended

[GnuPG-2.4.0](4.Security.md#46-gnupg-240) (to validate both the initial downloads, and also any updates you might later make using **tlmgr**.) [libwww-perl-6.67](13.Programming.md#1319-perl-modules) (to use a single connection to the server, which will reduce its load and speed things up.)

#### Recommended (at runtime)

The binaries are mostly linked to included static libraries or general (LFS) system libraries, but a few of the programs and several scripts will fail if the following packages are not present:

[ghostscript-10.00.0](46.Printing.md#463-ghostscript-10000) is dynamically loaded by the external application [dvisvgm](https://dvisvgm.de/), which is used by asy when that creates SVG files.

[Xorg Libraries](24.Graphical_environments.md#248-xorg-libraries) and [libxcb-1.15](24.Graphical_environments.md#247-libxcb-115) are needed for inimf, mf, pdfclose, pdfopen and xdvi-xaw. But if you are using asy, or using a TeX engine to create a PDF file, you will need [a graphical environment](24.Graphical_environments.md) (for PDF files, this is to support a PDF viewer of your choice, for example [epdfview-0.1.8](50.PostScript.md#502-epdfview-018)).

The binary version of asy needs [Freeglut-3.4.0](25.Graphical_environment_libraries.md#2512-freeglut-340).

### Note

As always with contributed binary software, it is possible that the required dependencies may change when the installer is updated. In particular, these dependencies have only been checked on x86_64.

[Python-2.7.18](13.Programming.md#1322-python-2718) is used by many scripts - most are unmaintained. Many invoke `/usr/bin/env python`, a couple invoke `/usr/bin/python`. It is not generally known if these will work with a symlink to **python3** (as used in some distros) and two from pythontex invoke **python2**. [Ruby-3.2.1](13.Programming.md#1326-ruby-321) is used by some scripts, mostly within mtx_context which is part of conTeXt, but also for one or two others, such as match_parens, which are generally useful. The perl module [Tk](https://cpan.metacpan.org/authors/id/S/SR/SREZIC/Tk-804.035.tar.gz), which needs to be run from an X11 session to run the tests and requires [Tk-8.6.13](13.Programming.md#1334-tk-8613), is used by one of the scripts for ptex (Japanese vertical writing), can be used by a conTeXt texfind script, and is needed for texdoctk (a GUI interface for finding documentation files and opening them with the appropriate viewer). **ps2pdf**, from [ghostscript-10.00.0](46.Printing.md#463-ghostscript-10000), is used by some utilities and scripts.

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/tl-installer](https://wiki.linuxfromscratch.org/blfs/wiki/tl-installer)

Binary Installation of TeX Live
-------------------------------

The TeX Live set of programs with its supporting documents, fonts, and utilities is very large. The upstream maintainers recommend placing all files in a single directory structure. BLFS recommends `/opt/texlive`.

As with any other package, unpack the installer and change into its directory, `install-tl-<CCYYMMDD>`. This directory name changes when the installer is updated, so replace <CCYYMMDD> by the correct directory name.

### Note

The distribution binaries installed below may use static linking for general linux system libraries. Additional libraries or interpreters as specified in the dependencies section do not need to be present during the install, but the programs that need them will not run until their specific dependencies have been installed.

With all contributed binary software, there may be a mismatch between the builder's toolchain and your hardware. In most of TeX this will probably not matter, but in uncommon corner cases you might hit problems. For example, if your x86_64 processor does not support 3dnowext or 3dnow, the 2014-06-28 binary failed in conTeXt when running LuaTeX, although lualatex worked, as did the i686 binaries on the same machine. In such cases, the easiest solution is to install texlive from source. Similarly, the x86_64 binary version of **asy** runs very slowly when creating 3-D diagrams.

Now, as the `root` user:

```bash
TEXLIVE_INSTALL_PREFIX=/opt/texlive ./install-tl
```

This command is interactive and allows selection or modification of platform, packages, directories, and other options. The full installation scheme will require about 4.9 gigabytes of disk space. The time to complete the download will depend on your internet connection speed and the number of packages selected.

It has been established by debian that the **python** scripts in `latex-make` will work with **python3**, so update them to invoke that by running the following command as the `root` user:

```bash
for F in /opt/texlive/2022/texmf-dist/scripts/latex-make/*.py ; do
  test -f $F && sed -i 's%/usr/bin/env python%/usr/bin/python3%' $F || true
done
```

Command Explanations
--------------------

**test -f $F && sed ...**: in a small install these files might not be present, so test if they exist and if not return 'true' to avoid any error if this command has been copied into one of your own install scripts.

`./install-tl --location http://mirror.aut.ac.nz/CTAN/systems/texlive/tlnet/`: use a variation of this if you wish to use a different mirror, for example, because you are in New Zealand but the installer chooses to use an Australian mirror. The list of mirrors is at [https://ctan.org/mirrors/](https://ctan.org/mirrors/).

Contents
--------

**Installed Programs:** Over 300 binaries and symlinks to scripts

**Installed Libraries:** None

**Installed Directories:** /opt/texlive

### Short Descriptions

**TeX programs**        The programs included in TeX are too numerous to individually list. Please refer to the individual program HTML and PDF pages in the various html, man, or pdf files within the subdirectories of `2022/texmf-dist/`. Using **texdoc pdflatex** ( replace pdflatex with the command name ) may also be useful.


## 51.3 texlive-20220321-source
--------

Introduction to TeX Live from source
------------------------------------

### Note

According to [https://www.tug.org/historic/](https://www.tug.org/historic/) the master site in France only supports ftp and rsync. Now that ftp is generally deprecated, that page has links to mirrors, some of which support https, e.g. in Utah and Chemntiz as well as in China. If you prefer to use a different mirror from the example links here, you will need to navigate to systems/historic/texlive/2022 or systems/texlive/2022 as the case may be.

Most of TeX Live can be built from source without a pre-existing installation, but xindy (for indexing) needs working versions of **latex** and **pdflatex** when configure is run, and the test suite and install for **asy** (for vector graphics) will fail if TeX has not already been installed. Additionally, biber is not provided within the texlive source and the version of dvisvgm in the texlive tree cannot be built if shared system libraries are used.

All of those packages are dealt with on their own pages and can be built after installing this package. If you have not already done so, you should start at [Setting the PATH for TeX Live](51.Typesetting.md#511-setting-the-path-for-tex-live) so that the final commands to initialize the new installation will be found.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://ftp.math.utah.edu/pub/tex/historic/systems/texlive/2022/texlive-20220321-source.tar.xz](https://ftp.math.utah.edu/pub/tex/historic/systems/texlive/2022/texlive-20220321-source.tar.xz)
    
*   Download (FTP): [ftp://tug.org/texlive/historic/2022/texlive-20220321-source.tar.xz](ftp://tug.org/texlive/historic/2022/texlive-20220321-source.tar.xz)
    
*   Download MD5 sum: 4f05bbd93004175275f50215a4c51608
    
*   Download size: 65 MB
    
*   Estimated disk space required: 8.0 GB including the additional download and the tests, 7.3 GB installed
    
*   Estimated build time: 3.9 SBU including the additional download and the tests, building with parallelism=4
    

### Required Additional Downloads

Much of the texlive environment (including scripts, documentation, fonts, and various other files) is not part of the source tarball. You must download it separately. This will give you all of the additional files which are provided by a full install of the binary version, there is no realistic way to restrict which parts get installed.

Because of the size of this package, it is unlikely to be mirrored by BLFS mirrors. In case of difficulty, go to <http://www.ctan.org/mirrors/> to find a more-accessible mirror.

*   Download (HTTP): [https://ftp.math.utah.edu/pub/tex/historic/systems/texlive/2022/texlive-20220321-texmf.tar.xz](https://ftp.math.utah.edu/pub/tex/historic/systems/texlive/2022/texlive-20220321-texmf.tar.xz)
    
*   Download (FTP): [ftp://tug.org/texlive/historic/2022/texlive-20220321-texmf.tar.xz](ftp://tug.org/texlive/historic/2022/texlive-20220321-texmf.tar.xz)
    
*   Download MD5 sum: 9806803f703b6ce4d9845c46806a7a08
    
*   Download size: 3.4 GB
    

From the 2019 year, the tlpdb database of the packages within texlive is no-longer installed with the source. But **texdoc** needs a cache file derived from this (and will create the cache on its first run).

*   Download (HTTP): [https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/2022/texlive-20220325-tlpdb-full.tar.gz](https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/2022/texlive-20220325-tlpdb-full.tar.gz)
    
*   Download (FTP): [ftp://tug.org/texlive/historic/2022/texlive-20220325-tlpdb-full.tar.gz](ftp://tug.org/texlive/historic/2022/texlive-20220325-tlpdb-full.tar.gz)
    
*   Download MD5 sum: 1084c37c6775b567ed7babd71e612f75
    
*   Download size: 3.1 MB
    

### TeX Live from source Dependencies

#### Recommended

[a graphical environment](24.Graphical_environments.md)

The source ships with its own versions of many libraries, and will use them unless it is forced to use the system versions. The following are recommended so that the system version will be used: [Cairo-1.17.6](25.Graphical_environment_libraries.md#254-cairo-1176), [Fontconfig-2.14.2](10.Graphics_and_font_libraries.md#105-fontconfig-2142), [FreeType-2.13.0](10.Graphics_and_font_libraries.md#104-freetype-2130), [GC-8.2.2](13.Programming.md#137-gc-822), [Graphite2-1.3.14](10.Graphics_and_font_libraries.md#1010-graphite2-1314), [HarfBuzz-7.0.0](10.Graphics_and_font_libraries.md#1011-harfbuzz-700) (built with graphite2 enabled), [ICU-72.1](9.General_libraries.md#919-icu-721), [libpaper-1.1.24+nmu5](9.General_libraries.md#949-libpaper-1124nmu5) (used by at least context and xelatex), and [libpng-1.6.39](10.Graphics_and_font_libraries.md#1020-libpng-1639)

Furthermore, the instructions below assume you are using the layout described in [Setting the PATH for TeX Live](51.Typesetting.md#511-setting-the-path-for-tex-live).

#### Optional

The source ships with its own versions of several libraries which are either not under active development, or only used for limited functionality. If you install these, as with some other optional dependencies in this book you will need to tell **configure** to use the system versions. [GD](https://libgd.github.io/), [t1lib](https://www.t1lib.org/), [ZZIPlib](https://github.com/gdraheim/zziplib/), [TECkit](https://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=TECkitDownloads)

#### Runtime dependencies

[Python-2.7.18](13.Programming.md#1322-python-2718) is used by many scripts - most are unmaintained. Many invoke `/usr/bin/env python`, a couple invoke `/usr/bin/python`. It is not generally known if these will work with a symlink to **python3** (as used in some distros) and two from pythontex invoke **python2**. [Ruby-3.2.1](13.Programming.md#1326-ruby-321) is used by some scripts, mostly within mtx_context which is part of conTeXt, but also for one or two others, such as match_parens, which are generally useful. The perl module [Tk](https://cpan.metacpan.org/authors/id/S/SR/SREZIC/Tk-804.035.tar.gz), which needs to be run from an X11 session to run the tests and requires [Tk-8.6.13](13.Programming.md#1334-tk-8613), is used by one of the scripts for ptex (Japanese vertical writing), can be used by a conTeXt texfind script, and is needed for texdoctk (a GUI interface for finding documentation files and opening them with the appropriate viewer). **ps2pdf**, from [ghostscript-10.00.0](46.Printing.md#463-ghostscript-10000), is used by some utilities and scripts.

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/texlive](https://wiki.linuxfromscratch.org/blfs/wiki/texlive)

Installation of TeX Live
------------------------

Install TeX Live by running the following commands:

### Caution

If you wish to upgrade to current texlive on an older system where extra packages (asymptote, biber, dvisvgm, or xindy) have been installed, you will need to reinstall those as well as fixing up your `PATH` for `$TEXLIVE_PREFIX`.

The shared libraries will be installed into a texlive directory. As the `root` user, add it to your `/etc/ld.so.conf`:

```bash
cat >> /etc/ld.so.conf << EOF
# Begin texlive addition

$TEXLIVE_PREFIX/lib

# End texlive addition
EOF
```

### Note

A successful install requires some texlive commands to be run as the root user, so we will export the TEXARCH variable to let `root` use it.

Now, as a normal user:

```bash
export TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/') &&

mkdir texlive-build &&
cd    texlive-build &&

../configure                                      \
    --prefix=$TEXLIVE_PREFIX                      \
    --bindir=$TEXLIVE_PREFIX/bin/$TEXARCH         \
    --datarootdir=$TEXLIVE_PREFIX                 \
    --includedir=$TEXLIVE_PREFIX/include          \
    --infodir=$TEXLIVE_PREFIX/texmf-dist/doc/info \
    --libdir=$TEXLIVE_PREFIX/lib                  \
    --mandir=$TEXLIVE_PREFIX/texmf-dist/doc/man   \
    --disable-native-texlive-build                \
    --disable-static --enable-shared              \
    --disable-dvisvgm                             \
    --with-system-cairo                           \
    --with-system-fontconfig                      \
    --with-system-freetype2                       \
    --with-system-gmp                             \
    --with-system-graphite2                       \
    --with-system-harfbuzz                        \
    --with-system-icu                             \
    --with-system-libgs                           \
    --with-system-libpaper                        \
    --with-system-libpng                          \
    --with-system-mpfr                            \
    --with-system-pixman                          \
    --with-system-zlib                            \
    --with-banner-add=" - BLFS" &&

make
```

To test the results, issue: **make check**.

Now, as the `root` user:

```bash
make install-strip &&
/sbin/ldconfig     &&
make texlinks      &&
mkdir -pv                                $TEXLIVE_PREFIX/tlpkg/TeXLive/ &&
install -v -m644 ../texk/tests/TeXLive/* $TEXLIVE_PREFIX/tlpkg/TeXLive/ &&
tar -xf ../../texlive-20220325-tlpdb-full.tar.gz -C $TEXLIVE_PREFIX/tlpkg
```

### Note

Only run **make texlinks** once. If it is rerun, it can change all the program symlinks so that they point to themselves and are useless.

Now install the additional files as the `root` user:

```bash
tar -xf ../../texlive-20220321-texmf.tar.xz -C $TEXLIVE_PREFIX --strip-components=1
```

It has been established by debian that the **python** scripts in `latex-make` will work with **python3**, so update them to invoke that by running the following command as the `root` user:

```bash
for F in $TEXLIVE_PREFIX/texmf-dist/scripts/latex-make/*.py ; do
  sed -i 's%/usr/bin/env python%/usr/bin/python3%' $F
done
```

Still as the `root` user, initialize the new system (the commands **fmtutil-sys --all** and **mtxrun --generate** will produce a lot of output):

```bash
mktexlsr &&
fmtutil-sys --all &&
mtxrun --generate
```

You can now proceed to [asymptote-2.85](51.Typesetting.md#514-asymptote-285), [biber-2.18](51.Typesetting.md#515-biber-218), [dvisvgm-3.0.3](51.Typesetting.md#516-dvisvgm-303) and / or [xindy-2.5.1](51.Typesetting.md#517-xindy-251) if you wish to install them.

Command Explanations
--------------------

`--prefix=, --bindir=, --datarootdir=, --infodir=, --mandir= ...` : these switches ensure that the files installed from source will overwrite any corresponding files previously installed by install-tl-unx so that the alternative methods of installing texlive are consistent.

`--includedir=, --libdir= ...` : these switches ensure that the libraries and include files will be within the directories for this year's texlive.

`--disable-static`: This switch prevents installation of static versions of the libraries.

`--enable-shared`: Use shared versions of `libkpathsea`, `libptexenc`, `libsynctex`, `libtexlua52` and `libtexluajit`.

`--with-system-...`: Unless this parameter is used, the included versions of these libraries will be statically compiled into the programs which need them. If you decided not to install a recommended library, omit the corresponding switch.

**--disable-dvisvgm**: As noted above, the shipped version of dvisvgm, which has modified configuration files, cannot be built with shared system libraries.

`--without-x`: use this if you do not have Xorg installed.

**/sbin/ldconfig**: this has to be run here so that **make texlinks** can use kpsewhich.

**make texlinks** : this runs the texlinks.sh script to create symbolic links from formats to engines. In practice, several of the targets such as **xetex** are now separate binaries and for these it will report "file already exists".

**tar -xf texlive-20220321-texmf.tar.xz -C $TEXLIVE_PREFIX --strip-components=1**: the tarball contains the files for the texmf-dist directory, and because of its size we do not want to waste time and space untarring it and then copying the files.

**install -v -m644 ../texk/tests/TeXLive/* $TEXLIVE_PREFIX/tlpkg/TeXLive/**: This puts the perl modules `TLConfig.pm` and `TLUtils.pm` into the directory where the binary installer puts them - it is at the start of the perl @INC@ PATH within texlive when installed using the above configure switches. Without these modules, texlive is unusable.

**mktexlsr**: Create an `ls-R` file which lists what was installed - this is used by kpathsea to find files.

**fmtutil-sys --all**: This initializes the TeX formats, Metafont bases and Metapost mems.

**mtxrun --generate**: This initializes the ConTeXt system.

Contents
--------

**Installed Programs:** Over 300 binaries and symlinks to scripts

**Installed Libraries:** libkpathsea.so, libptexenc.so, libsynctex.so, libtexlua52.so, libtexluajit.so

**Installed Directories:** $TEXLIVE_PREFIX/bin, $TEXLIVE_PREFIX/include, $TEXLIVE_PREFIX/lib, $TEXLIVE_PREFIX/texmf-dist

### Short Descriptions

**TeX programs**        The programs included in TeX are too numerous to individually list. Please refer to the individual program HTML and PDF pages in the various html, man, or pdf files within the subdirectories of `2022/texmf-dist/`. Using **texdoc pdflatex** ( replace pdflatex with the command name ) may also be useful

`libkpathsea.so`        (kpathsearch) exists to look up a file in a list of directories and is used by **kpsewhich**

`libptexenc.so`         is a library for Japanese pTeX (publishing TeX)

`libsynctex.so`         is the SyncTeX (Synchronize TeXnology) parser library

`libtexlua52.so`        provides Lua 5.2, modified for use with LuaTeX

`libtexluajit.so`       provides LuaJIT, modified for use with LuaJITTeX.


## 51.4 asymptote-2.85
--------

Introduction to asymptote
-------------------------

Asymptote is a powerful descriptive vector graphics language that provides a natural coordinate-based framework for technical drawing. Labels and equations can be typeset with LaTeX. As well as EPS, PDF and PNG output it can produce WebGL 3D HTML rendering and (using dvisvgm) SVG output.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://downloads.sourceforge.net/asymptote/asymptote-2.85.src.tgz](https://downloads.sourceforge.net/asymptote/asymptote-2.85.src.tgz)
    
*   Download MD5 sum: 063786b8914f718d3bccf9d9168458f1
    
*   Download size: 15 MB
    
*   Estimated disk space required: 222 MB (55 MB installed,with all the dependencies which are within BLFS)
    
*   Estimated build time: 1.3 SBU (using parallelism=4)
    

### asymptote Dependencies

#### Required

[ghostscript-10.00.0](46.Printing.md#463-ghostscript-10000) and [texlive-20220321](51.Typesetting.md#513-texlive-20220321-source)

#### Recommended

[cURL-7.88.1](17.Networking_libraries.md#172-curl-7881), [Freeglut-3.4.0](25.Graphical_environment_libraries.md#2512-freeglut-340), [GC-8.2.2](13.Programming.md#137-gc-822), [GLEW-2.2.0](25.Graphical_environment_libraries.md#2515-glew-220), [GLM-0.9.9.8](10.Graphics_and_font_libraries.md#109-glm-0998) and [libtirpc-1.3.3](17.Networking_libraries.md#1718-libtirpc-133)

#### Recommended at runtime

[dvisvgm-3.0.3](51.Typesetting.md#516-dvisvgm-303) to allow svg output

#### Optional

[fftw-3.3.10](9.General_libraries.md#912-fftw-3310), [Gsl-2.7.1](9.General_libraries.md#917-gsl-271), [libsigsegv-2.14](9.General_libraries.md#956-libsigsegv-214), both [Boost-1.81.0](9.General_libraries.md#94-boost-1810) and [rapidjson](https://github.com/Tencent/rapidjson/releases/) to use [LSP](https://microsoft.github.io/language-server-protocol/implementors/tools/) which can be used with [emacs](https://asymptote.sourceforge.io/doc/Language-server-protocol.html#index-LSP/), and [eigen](https://eigen.tuxfamily.org/)

#### Optional (at runtime)

[ImageMagick-7.1.0-61](11.General_utilities.md#1110-imagemagick-710-61) to convert output to other formats such as JPEG or to create animated GIFs, [PyQt5](https://pypi.org/project/PyQt5/) (not tested, has a build dependency of [Qt-5.15.8](25.Graphical_environment_libraries.md#2544-qt-5158)) to use xasy.

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/asymptote](https://wiki.linuxfromscratch.org/blfs/wiki/asymptote)

Installation of asymptote
-------------------------

### Note

Certain 3D PDF scripts may not work when invoked from pdflatex on some zen+ amdgpu APU machines.

Install asymptote by running the following commands:

```bash
export TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/') &&

./configure --prefix=$TEXLIVE_PREFIX                          \
            --bindir=$TEXLIVE_PREFIX/bin/$TEXARCH             \
            --datarootdir=$TEXLIVE_PREFIX/texmf-dist          \
            --infodir=$TEXLIVE_PREFIX/texmf-dist/doc/info     \
            --libdir=$TEXLIVE_PREFIX/texmf-dist               \
            --mandir=$TEXLIVE_PREFIX/texmf-dist/doc/man       \
            --disable-lsp                                     \
            --enable-gc=system                                \
            --with-latex=$TEXLIVE_PREFIX/texmf-dist/tex/latex \
            --with-context=$TEXLIVE_PREFIX/texmf-dist/tex/context/third &&

make
```

To test the results, issue: **make check**.

Now, as the `root` user:

```bash
make install
```

Command Explanations
--------------------

`--prefix=, --bindir=, --datarootdir=, --infodir=, --mandir= ...` : these switches ensure that the files installed from source will overwrite any corresponding files previously installed by install-tl-unx so that the alternative methods of installing texlive are consistent.

`--libdir=$TEXLIVE_PREFIX/texmf-dist;`: This parameter ensures that the `asymptote` directory will similarly overwrite any files installed by install-tl-unx.

`--disable-lsp`: The Language Server Protocol is enabled by default, with several third-party sources included, but it does not build unless boost and repidjson have been installed.

`--enable-gc=system`: this ensures that the system version of `libgc.so` will be used instead of the version shipped with this package.

`--with-latex= ... --with-context=`: These switches ensure that style files and a tex file will be installed into the texlive directories instead of creating a `texmf-local` directory for them.

Contents
--------

**Installed Programs:** asy, xasy

**Installed Libraries:** None

**Installed Directory:** $TEXLIVE_PREFIX/texmf-dist/asymptote, $TEXLIVE_PREFIX/doc/asymptote, $TEXLIVE_PREFIX/info/asymptote

### Short Descriptions

**asy**                 is a vector graphics program

**xasy**                is a Python3 script providing a Qt5 GUI for asy.


## 51.5 biber-2.18
--------

Introduction to biber
---------------------

Biber is a BibTeX replacement for users of biblatex, written in Perl, with full Unicode support.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://github.com/plk/biber/archive/v2.18/biber-2.18.tar.gz](https://github.com/plk/biber/archive/v2.18/biber-2.18.tar.gz)
    
*   Download MD5 sum: 5a503052bf88aff12dcef7a2d8a8e4f2
    
*   Download size: 1.5 MB
    
*   Estimated disk space required: 14 MB
    
*   Estimated build time: 0.4 SBU including tests

### Note

If you have updated to a new release of texlive-source, biber and its perl dependencies are still present in `/usr` and do not need to be rebuilt. However, biblatex installs in `/opt/texlive/2022` and does need to be reinstalled.

If you installed the above dependencies using the BLFS instructions for each of them, **perl ./Build.PL** will complain that Mozilla::CA is not installed, but that is not needed unless CPAN was used to install the modules. BLFS patches LWP::Protocol::https to use the system certificates, Mozilla::CA uses old certificates.

### Required Additional Download

*   Download (HTTP): [https://sourceforge.net/projects/biblatex/files/biblatex-3.18/biblatex-3.18b.tds.tgz](https://sourceforge.net/projects/biblatex/files/biblatex-3.18/biblatex-3.18b.tds.tgz)
    
*   Download MD5 sum: cd4c996e5ad4431c9f89c6e6c37a38df
    
*   Download size: 18 MB
    

### Biber Dependencies

#### Required

[autovivification-0.18](13.Programming.md#1319-perl-modules) [Business-ISBN-3.007](13.Programming.md#1319-perl-modules) [Business-ISMN-1.202](13.Programming.md#1319-perl-modules) [Business-ISSN-1.005](13.Programming.md#1319-perl-modules) [Class-Accessor-0.51](13.Programming.md#1319-perl-modules) [Data-Compare-1.27](13.Programming.md#1319-perl-modules) [Data-Dump-1.25](13.Programming.md#1319-perl-modules) [Data-Uniqid-0.12](13.Programming.md#1319-perl-modules) [DateTime-Calendar-Julian-0.107](13.Programming.md#1319-perl-modules) [DateTime-Format-Builder-0.83](13.Programming.md#1319-perl-modules) [Encode-EUCJPASCII-0.03](13.Programming.md#1319-perl-modules) [Encode-HanExtra-0.23](13.Programming.md#1319-perl-modules) [Encode-JIS2K-0.03](13.Programming.md#1319-perl-modules) [File-Slurper-0.014](13.Programming.md#1319-perl-modules) [IO-String-1.08](13.Programming.md#1319-perl-modules) [IPC-Run3-0.048](13.Programming.md#1319-perl-modules) [Lingua-Translit-0.29](13.Programming.md#1319-perl-modules) [List-AllUtils-0.19](13.Programming.md#1319-perl-modules) [List-MoreUtils-0.430](13.Programming.md#1319-perl-modules) [Log-Log4perl-1.57](13.Programming.md#1319-perl-modules) [LWP-Protocol-https-6.10](13.Programming.md#1319-perl-modules) [Module-Build-0.4232](13.Programming.md#1319-perl-modules) [Parse-RecDescent-1.967015](13.Programming.md#1319-perl-modules) [PerlIO-utf8_strict-0.010](13.Programming.md#1319-perl-modules) [Regexp-Common-2017060201](13.Programming.md#1319-perl-modules) [Sort-Key-1.33](13.Programming.md#1319-perl-modules) [Text-BibTeX-0.89](13.Programming.md#1319-perl-modules) [Text-CSV-2.02](13.Programming.md#1319-perl-modules) [Text-Roman-3.5](13.Programming.md#1319-perl-modules) [Unicode-Collate-1.31](13.Programming.md#1319-perl-modules) [Unicode-LineBreak-2019.001](13.Programming.md#1319-perl-modules) [XML-LibXML-Simple-1.01](13.Programming.md#1319-perl-modules) [XML-LibXSLT-2.002001](13.Programming.md#1319-perl-modules) [XML-Writer-0.900](13.Programming.md#1319-perl-modules)

#### Recommended (required for the test suite)

[File-Which-1.27](13.Programming.md#1319-perl-modules) and [Test-Differences-0.69](13.Programming.md#1319-perl-modules)

### Note

It is possible to install all missing dependencies automatically. You must first install [Module-Build-0.4232](13.Programming.md#1319-perl-modules) using [automatic installation of perl modules](13.Programming.md#1319-perl-modules). Then run **perl ./Build.PL** and when it prompts you, become the root user and run **./Build installdeps** - this will use CPAN and as noted above it will use Mozilla::CA instead of using system certificates.

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/biber](https://wiki.linuxfromscratch.org/blfs/wiki/biber)

Installation of Biber
---------------------

Install Biber by running the following commands:

```bash
perl ./Build.PL &&
./Build
```

To test the results, enter: **./Build test**

Now, as the `root` user:

```bash
./Build install
```

The corresponding version of biblatex is a separate project. The tarball is pre-packaged for untarring into the `texmf-dist` directory. Install it as the `root` user:

```bash
tar -C $TEXLIVE_PREFIX/texmf-dist -xf ../biblatex-3.18b.tds.tgz
```

Contents
--------

**Installed Programs:** biber

**Installed Library:** None

**Installed Directory:** /usr/lib/perl5/site_perl/5.*{,/<arch>-linux/auto}/Biber

### Short Descriptions

**biber**               is used for producing bibliographies in LaTeX documents.


## 51.6 dvisvgm-3.0.3
--------

Introduction to dvisvgm
-----------------------

The dvisvgm package converts DVI, EPS and PDF files to SVG format.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://github.com/mgieseki/dvisvgm/releases/download/3.0.3/dvisvgm-3.0.3.tar.gz](https://github.com/mgieseki/dvisvgm/releases/download/3.0.3/dvisvgm-3.0.3.tar.gz)
    
*   Download MD5 sum: e3de28609b74a61ea496c85b3e0f0ef1
    
*   Download size: 2.9 MB
    
*   Estimated disk space required: 310 MB (44 MB installed, add 962 MB for the tests)
    
*   Estimated build time: 0.8 SBU (add 0.6 SBU for the tests, both using parallelism=4)
    

### dvisvgm Dependencies

#### Required

[Brotli-1.0.9](9.General_libraries.md#95-brotli-109), [ghostscript-10.00.0](46.Printing.md#463-ghostscript-10000), and [Potrace-1.16](10.Graphics_and_font_libraries.md#1032-potrace-116)

#### Recommended

[WOFF2-1.0.2](10.Graphics_and_font_libraries.md#1036-woff2-102)

#### Optional

[asciidoc-10.2.0](13.Programming.md#1324-python-modules) with [xmlto-0.0.28](49.Extensible_markup_language_XML.md#496-xmlto-0028) and [libxslt-1.1.37](9.General_libraries.md#968-libxslt-1137) (see command explanations), [dblatex](https://dblatex.sourceforge.net/) (with the above) and [xxHash](https://github.com/Cyan4973/xxHash/releases/latest) (the current version is included in the tarball)

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/dvisvgm](https://wiki.linuxfromscratch.org/blfs/wiki/dvisvgm)

Installation of dvisvgm
-----------------------

To enable the build system to link to `libkpathsea.so`, as the `root` user create a symlink from `/usr/lib`:

```bash
ln -svf $TEXLIVE_PREFIX/lib/libkpathsea.so /usr/lib
```

The test suite assumes that a modern version of Python has been installed as plain **python**. Changing this to use **python3** requires a sed to one `Makefile.in` file.

Install dvisvgm by running the following commands:

```bash
sed -i 's/python/&3/' tests/Makefile.in         &&
./configure                                     \
    --bindir=$TEXLIVE_PREFIX/bin/${TEXARCH}     \
    --mandir=$TEXLIVE_PREFIX/texmf-dist/doc/man \
    --with-kpathsea=$TEXLIVE_PREFIX             &&
make
```

To test the results, issue: **make check**.

Now, as the `root` user:

```bash
make install
```

Command Explanations
--------------------

**ln -svf $TEXLIVE_PREFIX/lib/libkpathsea.so /usr/lib**: Without this, the program will not link correctly,

`--with-kpathsea=$TEXLIVE_PREFIX`: This allows the build system to find the headers for `kpathsea`

Contents
--------

**Installed Programs:** dvisvgm

**Installed Libraries:** None

**Installed Directories:** None

### Short Descriptions

**dvisvgm**             converts DVI, EPS and PDF files to the SVG format.


## 51.7 xindy-2.5.1
--------

Introduction to xindy
---------------------

Xindy is an index processor that can be used to generate book-like indexes for arbitrary document-preparation systems. This includes systems such as TeX and LaTeX, the roff-family, and SGML/XML-based systems (e.g., HTML) that process some kind of text and generate indexing information.

This package is known to build and work properly using an LFS 11.3 platform.

### Package Information

*   Download (HTTP): [https://tug.ctan.org/support/xindy/base/xindy-2.5.1.tar.gz](https://tug.ctan.org/support/xindy/base/xindy-2.5.1.tar.gz)
    
*   Download MD5 sum: 221acfeeb0f6f8388f89a59c56491041
    
*   Download size: 506 KB
    
*   Estimated disk space required: 15 MB
    
*   Estimated build time: less than 0.1 SBU
    

### Required Additional Downloads

*   Required patch: [https://www.linuxfromscratch.org/patches/blfs/11.3/xindy-2.5.1-upstream_fixes-2.patch](https://www.linuxfromscratch.org/patches/blfs/11.3/xindy-2.5.1-upstream_fixes-2.patch)
    

### Xindy Dependencies

#### Required

[Clisp-2.49](13.Programming.md#133-clisp-249) and [texlive-20220321](51.Typesetting.md#513-texlive-20220321-source)

User Notes: [https://wiki.linuxfromscratch.org/blfs/wiki/xindy](https://wiki.linuxfromscratch.org/blfs/wiki/xindy)

Installation of xindy
---------------------

Install xindy by running the following commands:

```bash
export TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/') &&

sed -i "s/ grep -v '^;'/ awk NF/" make-rules/inputenc/Makefile.in &&

sed -i 's%\(indexentry\)%\1\\%' make-rules/inputenc/make-inp-rules.pl &&

patch -Np1 -i ../xindy-2.5.1-upstream_fixes-2.patch &&

./configure --prefix=$TEXLIVE_PREFIX              \
            --bindir=$TEXLIVE_PREFIX/bin/$TEXARCH \
            --datarootdir=$TEXLIVE_PREFIX         \
            --includedir=/usr/include             \
            --libdir=$TEXLIVE_PREFIX/texmf-dist   \
            --mandir=$TEXLIVE_PREFIX/texmf-dist/doc/man &&

make LC_ALL=POSIX
```

This package does not have a test suite.

Now, as the `root` user:

```bash
make install
```

Command Explanations
--------------------

**sed -i "s/ grep -v '^;'/ awk NF/" ...**: The build sorts files in latin{1..3} encodings to create latin.xdy, and unicode versions of these to create utf8.xdy after using **grep -v '^;'** to remove blank lines. With grep-2.23 any data not in the expected encoding is treated as binary, resulting in a useless file. This command uses an alternative way of removing blank lines.

**sed -i 's%\(indexentry\)%\1\\%' ...**: A regexp contains `indexentry{` - perl has warned about the unescaped left brace for some time and now treats it as illegal. Change it to `indexentry\{`, doubling the backslash for **sed**.

**patch -Np1 -i ../xindy-2.5.1-upstream_fixes-2.patch**: Xindy is now maintained at CTAN. This patch updates the source with some of the changes made there (but ignoring changes which were only made to allow for spaces in pathnames and some trivial recent changes).

`--prefix=, --bindir=, --datarootdir=, --infodir=, --mandir= ...` : these switches ensure that the files installed from source will overwrite any corresponding files previously installed by install-tl-unx so that the alternative methods of installing texlive are consistent.

`--includedir=/usr/include`: This parameter ensures that the `kpathsea` headers from [texlive-20220321](51.Typesetting.md#513-texlive-20220321-source) will be found.

**make LC_ALL=POSIX**: with the current version of coreutils it is essential to build xindy in the POSIX (or C) locale because in a UTF-8 locale the file `latin.xdy` will contain only a heading and then a line '`Binary file (standard input) matches`' instead of the many lines of lisp merge-rule commands it ought to contain.

Contents
--------

**Installed Programs:** tex2xindy, texindy, xindy

**Installed Libraries:** None

**Installed Directory:** $TEXLIVE_PREFIX/texmf-dist/xindy

### Short Descriptions

**tex2xindy**           transforms a LaTeX index file into a xindy raw index file

**texindy**             is a wrapper for xindy that turns on many LaTeX conventions by default

**xindy**               creates a sorted and tagged index from a raw LaTeX index.
